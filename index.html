<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Command Test</title>
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
	
</head>
<body>
    <h1>בדוק הוראות קוליות ל-OpenAI</h1>

    <button id="microphone-btn">הפעל מיקרופון</button>
    <div id="response"></div>
<script>    
	eruda.init();
</script>
    <script>
fetch("https://api.openai.com/v1/chat/completions", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Authorization": 'Berear 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';
       
  },
  body: JSON.stringify({
    model: "gpt-3.5-turbo",
    messages: [{ role: "user", content: "Hello!" }]
  })
})
.then(response => response.json())
.then(data => console.log(data))
.catch(error => console.error(error));


	    
        // המפתח שלך ל-OpenAI (הכנס כאן את המפתח שלך)
        const apiKey ='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';
      

        // URL של ה-API של OpenAI
        const openAiUrl = "https://api.openai.com/v1/completions";

        // הגדרות ה-OpenAI שלנו
        const settings = {
            "הוראות קוליות": "הבקשה היא הוראה קולית שנשלחה על ידי המשתמש",
            "סימולטור הלוואות": "אם המשתמש רוצה להשתמש בסימולטור הלוואות, יש צורך בפרמטרים כמו סכום הלוואה, תקופה, וריבית",
            "השוואת חברות": "המשתמש רוצה לבצע השוואת חברות, יש לזהות את שמות החברות ולהשוות ביניהן",
            "חישוב ערך עתידי": "המשתמש רוצה לחשב ערך עתידי, יש לוודא שהוא מספק סכום ראשוני או הפקדה חודשית, ריבית ותקופת השקעה",
            // הוסף כאן עוד את ההגדרות שלך...
        };

        // הפעלת המיקרופון והאזנה להוראות קוליות
        const microphoneBtn = document.getElementById('microphone-btn');
        const responseDiv = document.getElementById('response');
        
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'he-IL';
        
        microphoneBtn.addEventListener('click', () => {
            recognition.start();
        });
        
        recognition.onresult = function(event) {
            const command = event.results[0][0].transcript;
            console.log('הוראה קולית:', command);

            // כאן אנחנו שולחים את הקלט ל-OpenAI
            sendToOpenAI(command);
        };

        recognition.onerror = function(event) {
            console.error('שגיאה בהאזנה:', event.error);
        };

        // שליחה ל-OpenAI
        function sendToOpenAI(prompt) {
            // הכנס את כל ההגדרות לפני שליחת הבקשה
            const fullPrompt = `המשתמש שלח את הבקשה: "${prompt}". הנה ההגדרות שצריך לקחת בחשבון: ${JSON.stringify(settings)}.`;

            axios.post(openAiUrl, {
                model: "text-davinci-003", // המודל הנכון
                prompt: fullPrompt,
                max_tokens: 100,
            }, {
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json',
                }
            })
            .then(response => {
                // הדפס את התשובה המתקבלת
                console.log('תשובת OpenAI:', response.data);
                responseDiv.innerHTML = `<pre>${JSON.stringify(response.data, null, 2)}</pre>`;
            })
            .catch(error => {
                // הדפס את השגיאה
                console.error('שגיאה בבקשה ל-OpenAI:', error.response ? error.response.data : error.message);
                responseDiv.innerHTML = `<p>שגיאה: ${error.response ? error.response.data : error.message}</p>`;
            });
        }

    </script>

    <!-- כדי להשתמש ב-Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</body>
</html>
